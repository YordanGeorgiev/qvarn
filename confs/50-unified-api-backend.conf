# Set up unified-api-backend processes via FastCGI. This cruelly modifies global
# lighttpd configuration as well.

# /cards
$SERVER["socket"] == ":9001" {
    fastcgi.server = (
        "" =>
        (
            "python-fcgi" =>
                (
                    "socket" => "/run/lighttpd/unifiedapi-cards.socket",
                    "bin-path" => "/usr/bin/start-backend-app cards",
                    "check-local" => "disable",
                    "max-procs" => 2,
                )
        )
    )
}

# /contracts
$SERVER["socket"] == ":9002" {
    fastcgi.server = (
        "" =>
        (
            "python-fcgi" =>
                (
                    "socket" => "/run/lighttpd/unifiedapi-contracts.socket",
                    "bin-path" => "/usr/bin/start-backend-app contracts",
                    "check-local" => "disable",
                    "max-procs" => 2,
                )
        )
    )
}

# /events
$SERVER["socket"] == ":9003" {
    fastcgi.server = (
        "" =>
        (
            "python-fcgi" =>
                (
                    "socket" => "/run/lighttpd/unifiedapi-events.socket",
                    "bin-path" => "/usr/bin/start-backend-app events",
                    "check-local" => "disable",
                    "max-procs" => 2,
                )
        )
    )
}

# /orgs
$SERVER["socket"] == ":9004" {
    fastcgi.server = (
        "" =>
        (
            "python-fcgi" =>
                (
                    "socket" => "/run/lighttpd/unifiedapi-orgs.socket",
                    "bin-path" => "/usr/bin/start-backend-app orgs",
                    "check-local" => "disable",
                    "max-procs" => 2,
                )
        )
    )
}

# /persons
$SERVER["socket"] == ":9005" {
    fastcgi.server = (
        "" =>
        (
            "python-fcgi" =>
                (
                    "socket" => "/run/lighttpd/unifiedapi-persons.socket",
                    "bin-path" => "/usr/bin/start-backend-app persons",
                    "check-local" => "disable",
                    "max-procs" => 2,
                )
        )
    )
}

# /projects
$SERVER["socket"] == ":9006" {
    fastcgi.server = (
        "" =>
        (
            "python-fcgi" =>
                (
                    "socket" => "/run/lighttpd/unifiedapi-projects.socket",
                    "bin-path" => "/usr/bin/start-backend-app projects",
                    "check-local" => "disable",
                    "max-procs" => 2,
                )
        )
    )
}

# /reports
$SERVER["socket"] == ":9007" {
    fastcgi.server = (
        "" =>
        (
            "python-fcgi" =>
                (
                    "socket" => "/run/lighttpd/unifiedapi-reports.socket",
                    "bin-path" => "/usr/bin/start-backend-app reports",
                    "check-local" => "disable",
                    "max-procs" => 2,
                )
        )
    )
}

# /version
$SERVER["socket"] == ":9008" {
    fastcgi.server = (
        "" =>
        (
            "python-fcgi" =>
                (
                    "socket" => "/run/lighttpd/unifiedapi-version.socket",
                    "bin-path" => "/usr/bin/start-backend-app version",
                    "check-local" => "disable",
                    "max-procs" => 2,
                )
        )
    )
}

# /competences
$SERVER["socket"] == ":9009" {
    fastcgi.server = (
        "" =>
        (
            "python-fcgi" =>
                (
                    "socket" => "/run/lighttpd/unifiedapi-competences.socket",
                    "bin-path" => "/usr/bin/start-backend-app competences",
                    "check-local" => "disable",
                    "max-procs" => 2,
                )
        )
    )
}

# /competence_types
$SERVER["socket"] == ":9010" {
    fastcgi.server = (
        "" =>
        (
            "python-fcgi" =>
                (
                    "socket" => "/run/lighttpd/unifiedapi-competence-types.socket",
                    "bin-path" => "/usr/bin/start-backend-app competence-types",
                    "check-local" => "disable",
                    "max-procs" => 2,
                )
        )
    )
}
